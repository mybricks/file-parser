!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["file-parser"]=t():e["file-parser"]=t()}(this,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFromRXUIFile=t.getJSONFromRXUIFile=t.getJSONFromModule=void 0;const r=n(1),o=n(3);function i(e){return r.toJSON(e)}t.getJSONFromModule=i,t.getJSONFromRXUIFile=function(e){return i(o.parse(e).mainModule)},t.parseFromRXUIFile=function(e){return o.parse(e)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.toJSON=void 0;const s=i(n(2));t.toJSON=function({slot:e,frame:t}){let n;const r=e=>{if(e.comAry){const t=[];return e.comAry.forEach(e=>{let n;e.slots&&(n={},e.slots.forEach(e=>{const t=r(e);t&&(n[e.id]=t)})),t.push({id:e.runtime.id,def:e.runtime.def,slots:n})}),{comAry:t,style:e.style}}};n=r(e);const o=[],i=[],c=[],u={},f={},d={},a={},p={},l=(e,t)=>{if(e.rels&&(u[`${t}-${e.hostId}`]=e.rels),e.proxyPin){const n=e.proxyPin.parent;if(0===n._type){const r=n.id;f[`${t}-${e.hostId}`]={type:"frame",frameId:r,pinId:e.proxyPin.hostId}}}},y=(e,t)=>{if(e.conAry){const n=[];e.conAry.forEach(e=>{var t;const r=e.finishPin;if(!r)return;const o=r.parent;if(1===o._type){const t=r.forkedFrom||r,i=o.forkedFrom||o,s=e.startPin.parent._key,c=e.finishPin.parent._key;n.push({type:"com",startPinParentKey:s,finishPinParentKey:c,comId:i.runtime.id,def:i.runtime.def,pinId:t.hostId,pinType:t.type,direction:t.direction,extBinding:t.extBinding})}else{const e=r.forkedFrom||r,o=e.parent;if(0===o._type){const r=e.forkedAsJoint;if(r){const e={type:"frame",frameId:o.id,comId:o.parent?o.parent.runtime.id:void 0,pinId:r.hostId,pinType:r.type,direction:r.direction};n.push(e);const t=`${e.comId?e.comId+"-":""}${e.frameId}`;y(r,t)}else{const r=1===(null===(t=o.parent)||void 0===t?void 0:t._type)?o.parent.runtime.id:void 0;n.push({type:"frame",frameId:o.id,comId:r,pinId:e.hostId,pinType:e.type,direction:e.direction})}}}}),n.length>0&&(d[`${t}-${e.hostId}`]=n)}},m=e=>{e.inputPins&&e.inputPins.forEach(t=>{let n;n=e.parent&&1===e.parent._type?`${e.parent.runtime.id}-${e.id}`:e.parent?e.id:"_rootFrame_",y(t,n),l(t,n),e.parent||i.push({id:t.hostId,title:t.title,type:t.type,schema:t.schema,extValues:t.extValues})}),e.outputPins&&e.outputPins.forEach(t=>{e.parent||c.push({id:t.hostId,title:t.title,type:t.type,schema:t.schema})}),e.comAry&&e.comAry.forEach(t=>{var n,r;const i=t.runtime,c=i.def;o.find(e=>e.namespace===c.namespace&&e.version===c.version)||o.push(c);const u=[],f=[],d=[],h=i.geo;if(a[i.id]={def:c,frameId:e.parent?e.id:void 0,parentComId:null===(n=e.parent)||void 0===n?void 0:n.runtime.id,title:i.title,model:i.model,reservedEditorAry:h?h.reservedEditorAry:void 0,configs:u,inputs:f,outputs:d},t.configPins&&t.configPins.forEach(e=>{u.push(e.hostId)}),s.each(e=>{l(e,i.id),f.push(e.hostId)},t.inputPins,t.inputPinsInModel,t.inputPinExts),s.each(e=>{y(e,i.id),d.push(e.hostId)},t.outputPins,t.outputPinsInModel,t.outputPinExts),i._autoRun&&(null===(r=c.rtType)||void 0===r?void 0:r.match(/^js/))){const t=e.parent?`${e.parent.runtime.id}-${e.id}`:"_rootFrame_";let n=p[t];n||(n=p[t]=[]),n.push({id:i.id,def:c})}t.frames&&t.frames.forEach(e=>{m(e)})}),e.frameAry&&e.frameAry.forEach(e=>{m(e)})};return m(t),{deps:o,coms:a,slot:n,comsAutoRun:p,inputs:i,outputs:c,cons:d,pinRels:u,pinProxies:f}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.length=t.merge=t.find=t.each=void 0,t.each=function(e,...t){t.forEach(t=>{t&&t.forEach((n,r)=>{e(n,r,t)})})},t.find=function(e,...t){let n;return t.find(t=>{if(t)return n=t.find(t=>e(t))}),n},t.merge=function(...e){let t=[];return e.forEach(e=>{t=t.concat(e)}),t},t.length=function(...e){let t=0;return e.forEach(e=>{Array.isArray(e)&&(t+=e.length)}),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parse=void 0;const r=n(4);let o,i;t.parse=function(e){let t;const n=[];for(let n in e)if(n===r.KEY_STAGEVIEW){t=s(e[n]).mainModule}const o=e=>{e.comAry&&e.comAry.forEach(e=>{const t=e.runtime.def;if(t){const e=t.namespace+"@"+t.version;n.indexOf(e)<=0&&n.push(e)}e.slots&&e.slots.forEach(e=>{o(e)})})};return t.slot.slots.forEach(e=>{o(e)}),{mainModule:{slot:t.slot.slots[0],frame:t.frame.frames[0]},requireComs:n}};function s(e){if("object"!=typeof e||"object"!=typeof e.def||"object"!=typeof e.refs)throw new Error("Invalid data format.");const{def:t,refs:n,D:s}=e;if(s)if(s.W){const e={};Object.keys(s.W).forEach(t=>{e[s.W[t]]=t}),s.W=e,o=s}else o=Object.assign({W:{}},s);else o={C:{},W:{}};i={refs:n,didMap:{}};return function e(t,n){const{refs:s,didMap:c}=i;if(Array.isArray(t))return t.map(t=>e(t));if("object"==typeof t&&t){if(t[r.META_HASHCODE])return c[t[r.META_HASHCODE]]=n||t,n||t;const i=t._R_;if("string"==typeof i){if(!n&&c[i])return c[i];t=s[i],c[i]=n||t}let u,f;(f=t._F_)&&(u=function(){}),delete t._F_;let d=function(e,t){let n=[];do{if(e==Object.prototype||e==Function.prototype)break;try{n=n.concat(Object.getOwnPropertyNames(e))}catch(e){console.error(e)}}while(e=Object.getPrototypeOf(e));return n.filter(n=>{if(!t||t&&"function"!=typeof e[n])return"constructor"!=n&&!/^__.+/g.test(n)})}(t);if(d.length>0){const n=t[r.META_IGNORE];d.forEach(i=>{let s=o.W[i],c=t[i];if(s?(t[i]=void 0,delete t[i]):s=i,i===r.META_IGNORE)return;const u=function(e,t){let n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){let r=e;for(;void 0===n&&null!=(r=Object.getPrototypeOf(r))&&r!==Object.prototype;)n=Object.getOwnPropertyDescriptor(r,t)}return n}(t,s);if(!(u&&u.get&&!u.set||n&&n[s]||n&&n[s])){n&&console.log(s);const r=e(c);try{t[s]=r}catch(e){throw e}}})}}return t}(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.META_IGNORE=t.META_HASHCODE=t.PIN_KEYS=t.KEY_REF=t.KEY_STAGEVIEW=void 0,t.KEY_STAGEVIEW="xg.desn.stageview",t.KEY_REF="_R_",t.PIN_KEYS=["inputPins","outputPins","inputPinExts","outputPinsInModel","inputPinsInModel","outputPinExts"],t.META_HASHCODE="_hc_",t.META_IGNORE="_ignore_"}])}));